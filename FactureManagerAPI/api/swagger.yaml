---
swagger: "2.0"
info:
  description: "API De gestion de la facturation"
  version: "1.0.0"
  title: "Facturation API"
  termsOfService: "http://swagger.io/terms/"
  contact:
    email: "sebastien.piovesan@gmail.com"
  license:
    name: "Apache 2.0"
    url: "http://www.apache.org/licenses/LICENSE-2.0.html"
host: "localhost:3000"
basePath: "/v1"
tags:
- name: "customer"
  description: "gestion des customers"
- name: "customers"
  description: "gestion des customers"
- name: "invoice"
  description: "gestion des invoices"
- name: "ligne"
  description: "gestion des lignes de invoice"
- name: "product"
  description: "gestion des products"
schemes:
- "http"
paths:
  /customer:
    post:
      tags:
      - "customer"
      summary: "Ajoute un nouveau customer"
      description: ""
      operationId: "addCustomer"
      consumes:
      - "application/json"
      - "application/xml"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - in: "body"
        name: "body"
        description: "description d'un customer à ajouter a la base de données"
        required: true
        schema:
          $ref: "#/definitions/body_customer"
      responses:
        405:
          description: "Invalid input"
      security:
      - facturation_auth:
        - "write:customers"
        - "read:customers"
      x-swagger-router-controller: "Customer"
    put:
      tags:
      - "customer"
      summary: "Met à jour un customer existant"
      description: ""
      operationId: "updateCustomer"
      consumes:
      - "application/json"
      - "application/xml"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - in: "body"
        name: "body"
        description: "description d'un customer à ajouter a la base de données"
        required: true
        schema:
          $ref: "#/definitions/body_customer"
      responses:
        400:
          description: "Invalid ID supplied"
        404:
          description: "Customer not found"
        405:
          description: "Validation exception"
      security:
      - facturation_auth:
        - "write:customers"
        - "read:customers"
      x-swagger-router-controller: "Customer"
  /customer/{customerId}:
    get:
      tags:
      - "customer"
      summary: "Find customer by ID"
      description: "Returns a single customer"
      operationId: "getCustomerById"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - name: "customerId"
        in: "path"
        description: "ID of customer to return"
        required: true
        type: "string"
      responses:
        200:
          description: "successful operation"
          schema:
            $ref: "#/definitions/customer_response_200"
        400:
          description: "Invalid ID supplied"
        404:
          description: "Customer not found"
      security:
      - api_key: []
      x-swagger-router-controller: "Customer"
    post:
      tags:
      - "customer"
      summary: "Updates a customer in the store with form data"
      description: ""
      operationId: "updateCustomerWithForm"
      consumes:
      - "application/x-www-form-urlencoded"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - name: "customerId"
        in: "path"
        description: "ID of customer that needs to be updated"
        required: true
        type: "string"
      - name: "name"
        in: "formData"
        description: "Updated name of the customer"
        required: false
        type: "string"
      - name: "address"
        in: "formData"
        description: "Updated address of the customer"
        required: false
        type: "string"
      - name: "zipcode"
        in: "formData"
        description: "Updated zipcode of the customer"
        required: false
        type: "string"
      - name: "city"
        in: "formData"
        description: "Updated city of the customer"
        required: false
        type: "string"
      responses:
        405:
          description: "Invalid input"
      security:
      - facturation_auth:
        - "write:customers"
        - "read:customers"
      x-swagger-router-controller: "Customer"
    delete:
      tags:
      - "customer"
      summary: "Deletes a customer"
      description: ""
      operationId: "deleteCustomer"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - name: "api_key"
        in: "header"
        required: false
        type: "string"
      - name: "customerId"
        in: "path"
        description: "Customer id to delete"
        required: true
        type: "string"
      responses:
        400:
          description: "Invalid ID supplied"
        404:
          description: "Customer not found"
      security:
      - facturation_auth:
        - "write:customers"
        - "read:customers"
      x-swagger-router-controller: "Customer"
  /customers:
    get:
      tags:
      - "customers"
      summary: "Find customers"
      description: "Returns all customers"
      operationId: "getCustomers"
      produces:
      - "application/xml"
      - "application/json"
      responses:
        200:
          description: "successful operation"
          schema:
            $ref: "#/definitions/customers_response_200"
        400:
          description: "Invalid ID supplied"
        404:
          description: "no customer not found"
      security:
      - api_key: []
      x-swagger-router-controller: "Customers"
  /invoice:
    post:
      tags:
      - "invoice"
      summary: "Ajoute une nouvelle facture"
      description: ""
      operationId: "addInvoice"
      consumes:
      - "application/json"
      - "application/xml"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - in: "body"
        name: "body"
        description: "description d'une facture à ajouter a la base de données"
        required: true
        schema:
          $ref: "#/definitions/body_invoice"
      responses:
        405:
          description: "Invalid input"
      security:
      - facturation_auth:
        - "write:invoices"
        - "read:invoices"
      x-swagger-router-controller: "Invoice"
    put:
      tags:
      - "invoice"
      summary: "Met à jour un invoice existant"
      description: ""
      operationId: "updateInvoice"
      consumes:
      - "application/json"
      - "application/xml"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - in: "body"
        name: "body"
        description: "description d'un invoice à ajouter a la base de données"
        required: true
        schema:
          $ref: "#/definitions/body_invoice"
      responses:
        400:
          description: "Invalid ID supplied"
        404:
          description: "Invoice not found"
        405:
          description: "Validation exception"
      security:
      - facturation_auth:
        - "write:invoices"
        - "read:invoices"
      x-swagger-router-controller: "Invoice"
  /customer/{customerId}/invoice/:
    get:
      tags:
      - "invoice"
      summary: "Find current invoice by customer ID"
      description: "Returns the current invoice (status opened) for the customer in parameter"
      operationId: "getCurrentInvoiceByCustomerId"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - name: "customerId"
        in: "path"
        description: "ID of customer"
        required: true
        type: "string"
      responses:
        200:
          description: "successful operation"
          schema:
            $ref: "#/definitions/invoice_response_200"
        400:
          description: "Invalid ID supplied"
        404:
          description: "Invoice not found"
      security:
      - api_key: []
      x-swagger-router-controller: "Invoice"
  /invoice/{invoiceId}:
    get:
      tags:
      - "invoice"
      summary: "Find invoice by ID"
      description: "Returns a single invoice"
      operationId: "getInvoiceById"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - name: "invoiceId"
        in: "path"
        description: "ID of invoice to return"
        required: true
        type: "string"
      responses:
        200:
          description: "successful operation"
          schema:
            $ref: "#/definitions/invoice_response_200"
        400:
          description: "Invalid ID supplied"
        404:
          description: "Invoice not found"
      security:
      - api_key: []
      x-swagger-router-controller: "Invoice"
    post:
      tags:
      - "invoice"
      summary: "Updates a invoice in the store with form data"
      description: ""
      operationId: "updateInvoiceWithForm"
      consumes:
      - "application/x-www-form-urlencoded"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - name: "invoiceId"
        in: "path"
        description: "ID of invoice that needs to be updated"
        required: true
        type: "string"
      - name: "status"
        in: "formData"
        required: true
        type: "string"
        format: "Order Status"
      responses:
        405:
          description: "Invalid input"
      security:
      - facturation_auth:
        - "write:invoices"
        - "read:invoices"
      x-swagger-router-controller: "Invoice"
    delete:
      tags:
      - "invoice"
      summary: "Deletes a invoice"
      description: ""
      operationId: "deleteInvoice"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - name: "api_key"
        in: "header"
        required: false
        type: "string"
      - name: "invoiceId"
        in: "path"
        description: "Invoice id to delete"
        required: true
        type: "string"
      responses:
        400:
          description: "Invalid ID supplied"
        404:
          description: "Invoice not found"
      security:
      - facturation_auth:
        - "write:invoices"
        - "read:invoices"
      x-swagger-router-controller: "Invoice"
  /ligne:
    post:
      tags:
      - "ligne"
      summary: "Ajoute une nouvelle ligne"
      description: ""
      operationId: "addLigne"
      consumes:
      - "application/json"
      - "application/xml"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - in: "body"
        name: "body"
        description: "description d'une ligne à ajouter a la base de données"
        required: true
        schema:
          $ref: "#/definitions/body_line"
      responses:
        405:
          description: "Invalid input"
      security:
      - facturation_auth:
        - "write:lignes"
        - "read:lignes"
      x-swagger-router-controller: "Ligne"
    put:
      tags:
      - "ligne"
      summary: "Met à jour un ligne existant"
      description: ""
      operationId: "updateLigne"
      consumes:
      - "application/json"
      - "application/xml"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - in: "body"
        name: "body"
        description: "description d'un ligne à ajouter a la base de données"
        required: true
        schema:
          $ref: "#/definitions/body_line"
      responses:
        400:
          description: "Invalid ID supplied"
        404:
          description: "Ligne not found"
        405:
          description: "Validation exception"
      security:
      - facturation_auth:
        - "write:lignes"
        - "read:lignes"
      x-swagger-router-controller: "Ligne"
  /ligne/{ligneId}:
    get:
      tags:
      - "ligne"
      summary: "Find ligne by ID"
      description: "Returns a single ligne"
      operationId: "getLigneById"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - name: "ligneId"
        in: "path"
        description: "ID of ligne to return"
        required: true
        type: "string"
      responses:
        200:
          description: "successful operation"
          schema:
            $ref: "#/definitions/line_response_200"
        400:
          description: "Invalid ID supplied"
        404:
          description: "Ligne not found"
      security:
      - api_key: []
      x-swagger-router-controller: "Ligne"
    post:
      tags:
      - "ligne"
      summary: "Updates a ligne in the store with form data"
      description: ""
      operationId: "updateLigneWithForm"
      consumes:
      - "application/x-www-form-urlencoded"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - name: "ligneId"
        in: "path"
        description: "ID of ligne that needs to be updated"
        required: true
        type: "string"
      - name: "invoiceId"
        in: "formData"
        required: true
        type: "string"
      - name: "quantity"
        in: "formData"
        required: true
        type: "integer"
        format: "int32"
      - name: "price"
        in: "formData"
        required: true
        type: "number"
        format: "double"
      - name: "description"
        in: "formData"
        required: true
        type: "string"
      responses:
        405:
          description: "Invalid input"
      security:
      - facturation_auth:
        - "write:lignes"
        - "read:lignes"
      x-swagger-router-controller: "Ligne"
    delete:
      tags:
      - "ligne"
      summary: "Deletes a ligne"
      description: ""
      operationId: "deleteLigne"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - name: "api_key"
        in: "header"
        required: false
        type: "string"
      - name: "ligneId"
        in: "path"
        description: "Ligne id to delete"
        required: true
        type: "string"
      responses:
        400:
          description: "Invalid ID supplied"
        404:
          description: "Ligne not found"
      security:
      - facturation_auth:
        - "write:lignes"
        - "read:lignes"
      x-swagger-router-controller: "Ligne"
  /product:
    post:
      tags:
      - "product"
      summary: "Ajoute une nouvelle product"
      description: ""
      operationId: "addProduct"
      consumes:
      - "application/json"
      - "application/xml"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - in: "body"
        name: "body"
        description: "description d'une product à ajouter a la base de données"
        required: true
        schema:
          $ref: "#/definitions/body_product"
      responses:
        405:
          description: "Invalid input"
      security:
      - facturation_auth:
        - "write:products"
        - "read:products"
      x-swagger-router-controller: "Product"
    put:
      tags:
      - "product"
      summary: "Met à jour un product existant"
      description: ""
      operationId: "updateProduct"
      consumes:
      - "application/json"
      - "application/xml"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - in: "body"
        name: "body"
        description: "description d'un product à ajouter a la base de données"
        required: true
        schema:
          $ref: "#/definitions/body_product"
      responses:
        400:
          description: "Invalid ID supplied"
        404:
          description: "Product not found"
        405:
          description: "Validation exception"
      security:
      - facturation_auth:
        - "write:products"
        - "read:products"
      x-swagger-router-controller: "Product"
  /product/{productId}:
    get:
      tags:
      - "product"
      summary: "Find product by ID"
      description: "Returns a single product"
      operationId: "getProductById"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - name: "productId"
        in: "path"
        description: "ID of product to return"
        required: true
        type: "string"
      responses:
        200:
          description: "successful operation"
          schema:
            $ref: "#/definitions/product_response_200"
        400:
          description: "Invalid ID supplied"
        404:
          description: "Product not found"
      security:
      - api_key: []
      x-swagger-router-controller: "Product"
    post:
      tags:
      - "product"
      summary: "Updates a product in the store with form data"
      description: ""
      operationId: "updateProductWithForm"
      consumes:
      - "application/x-www-form-urlencoded"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - name: "productId"
        in: "path"
        description: "ID of product that needs to be updated"
        required: true
        type: "string"
      - name: "description"
        in: "formData"
        required: true
        type: "string"
      - name: "prixunitaire"
        in: "formData"
        required: true
        type: "number"
        format: "double"
      responses:
        405:
          description: "Invalid input"
      security:
      - facturation_auth:
        - "write:products"
        - "read:products"
      x-swagger-router-controller: "Product"
    delete:
      tags:
      - "product"
      summary: "Deletes a product"
      description: ""
      operationId: "deleteProduct"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - name: "api_key"
        in: "header"
        required: false
        type: "string"
      - name: "productId"
        in: "path"
        description: "Product id to delete"
        required: true
        type: "string"
      responses:
        400:
          description: "Invalid ID supplied"
        404:
          description: "Product not found"
      security:
      - facturation_auth:
        - "write:products"
        - "read:products"
      x-swagger-router-controller: "Product"
  /products:
    get:
      tags:
      - "products"
      summary: "Find products"
      description: "Returns all products"
      operationId: "getProducts"
      produces:
      - "application/xml"
      - "application/json"
      responses:
        200:
          description: "successful operation"
          schema:
            $ref: "#/definitions/products_response_200"
        400:
          description: "Invalid ID supplied"
        404:
          description: "no product found"
      security:
      - api_key: []
      x-swagger-router-controller: "Products"
securityDefinitions:
  facturation_auth:
    type: "oauth2"
    authorizationUrl: "http://localhost:3000/oauth/dialog"
    flow: "implicit"
    scopes:
      write:customers: "modify customers in your account"
      read:customers: "read your customers"
      write:invoices: "modify invoices in your account"
      read:invoices: "read your invoices"
      write:lignes: "modify invoices in your account"
      read:lignes: "read your invoices"
      write:products: "modify invoices in your account"
      read:products: "read your invoices"
  api_key:
    type: "apiKey"
    name: "api_key"
    in: "header"
definitions:
  Invoice:
    type: "object"
    properties:
      _id:
        type: "string"
      customerId:
        type: "string"
      number:
        type: "string"
      creation_date:
        type: "string"
        format: "date-time"
      start_period:
        type: "string"
        format: "date"
      end_period:
        type: "string"
        format: "date"
      status:
        type: "string"
        description: "Order Status"
        enum:
        - "under_construction"
        - "validated"
        - "edited"
    xml:
      name: "Invoice"
  Ligne:
    type: "object"
    properties:
      _id:
        type: "string"
      invoiceId:
        type: "string"
      productId:
        type: "string"
      description:
        type: "string"
      quantite:
        type: "integer"
        format: "int64"
      price:
        type: "number"
        format: "double"
    xml:
      name: "Ligne"
  Product:
    type: "object"
    properties:
      _id:
        type: "string"
      description:
        type: "string"
      price:
        type: "number"
        format: "double"
    xml:
      name: "Product"
  Customer:
    type: "object"
    properties:
      _id:
        type: "string"
      name:
        type: "string"
      address:
        type: "string"
      zipcode:
        type: "string"
      city:
        type: "string"
    xml:
      name: "Customer"
  ApiResponse:
    type: "object"
    properties:
      code:
        type: "integer"
        format: "int32"
      type:
        type: "string"
      message:
        type: "string"
  customer_response_200:
    properties:
      _id:
        type: "string"
      name:
        type: "string"
      address:
        type: "string"
      zipcode:
        type: "string"
      city:
        type: "string"
    xml:
      name: "Customer"
  line_response_200:
    properties:
      _id:
        type: "string"
      invoiceId:
        type: "string"
      productId:
        type: "string"
      description:
        type: "string"
      quantite:
        type: "integer"
        format: "int64"
      price:
        type: "number"
        format: "double"
    xml:
      name: "Ligne"
  product_response_200:
    properties:
      _id:
        type: "string"
      description:
        type: "string"
      price:
        type: "number"
        format: "double"
    xml:
      name: "Product"
  invoice_response_200:
    properties:
      _id:
        type: "string"
      customerId:
        type: "string"
      number:
        type: "string"
      creation_date:
        type: "string"
        format: "date-time"
      start_period:
        type: "string"
        format: "date"
      end_period:
        type: "string"
        format: "date"
      status:
        type: "string"
        description: "Order Status"
        enum:
        - "under_construction"
        - "validated"
        - "edited"
    xml:
      name: "Invoice"
  customers_response_200:
    properties:
      customers:
        type: "array"
        xml:
          name: "Customers"
          wrapped: true
        items:
          $ref: "#/definitions/Customer"
  products_response_200:
    properties:
      customers:
        type: "array"
        xml:
          name: "Products"
          wrapped: true
        items:
          $ref: "#/definitions/Product"
  body_invoice:
    type: "object"
    properties:
      customerId:
        type: "string"
      number:
        type: "string"
      creation_date:
        type: "string"
        format: "date-time"
      start_period:
        type: "string"
        format: "date"
      end_period:
        type: "string"
        format: "date"
      status:
        type: "string"
        description: "Order Status"
        enum:
        - "under_construction"
        - "validated"
        - "edited"
    xml:
      name: "Invoice"
  body_line:
    type: "object"
    properties:
      invoiceId:
        type: "string"
      productId:
        type: "string"
      description:
        type: "string"
      quantite:
        type: "integer"
        format: "int64"
      price:
        type: "number"
        format: "double"
    xml:
      name: "Ligne"
  body_product:
    type: "object"
    properties:
      description:
        type: "string"
      price:
        type: "number"
        format: "double"
    xml:
      name: "Product"
  body_customer:
    type: "object"
    properties:
      _id:
        type: "string"
      name:
        type: "string"
      address:
        type: "string"
      zipcode:
        type: "string"
      city:
        type: "string"
    xml:
      name: "Customer"
externalDocs:
  description: "Find out more about Swagger"
  url: "http://swagger.io"
